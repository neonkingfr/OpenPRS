;;;
;;; File: /users/oprs/C/ACS/oprs-1.1/data/test/read.opf
;;; $Id$
;;; Date: Wed Nov 17 17:08:26 1993
;;; Host: cascade
;;; OP Editor Version : 1.1.14
;;; Compiled on cascade (Wed Nov 17 16:44:13 MET 1993)
;;; OP File Format: 2
;;;
(2 
(
AP-WAIT-TEST
AP-WAIT-TEST2
FOO
TEST-READ-RESPONSE
TEST-READ-RESPONSE-ID
TEST-READ-RESPONSE-ID-VAR
TEST1
TEST2
WAIT-TEST
WAIT-TEST2
)
(TESTWAIT (
(INVOCATION INVOCATION (AP-WAIT-TEST) 10 50 1 80 0 )
(CONTEXT CONTEXT  10 150 0 60 0 )
(SETTING SETTING  10 250 0 60 0 )
(EFFECTS EFFECTS () 10 350 0 60 0 )
(DOCUMENTATION DOCUMENTATION "The simplest way to read a value." 6 131 1 60 0 )
(PROPERTIES PROPERTIES () 10 400 0 60 0 )
) (
(START START 0 0 332 18)
(PROCESS N0 0 0 343 117)
(PROCESS N1 0 0 343 222)
(END END1 0 0 336 321)
) (
(GOAL START E0 N0
(^ (WAIT-TEST FOO $X))
()  0 0 40 0)
(GOAL N0 E1 N1
(! (PRINT $X))
()  0 0 40 0)
(GOAL N1 E2 END1
(~> (WAIT-TEST FOO $X))
()  0 0 40 0)
) )
(TESTWAIT2 (
(INVOCATION INVOCATION (AP-WAIT-TEST2) 10 50 1 80 0 )
(CONTEXT CONTEXT  10 150 0 60 0 )
(SETTING SETTING  10 250 0 60 0 )
(EFFECTS EFFECTS () 10 350 0 60 0 )
(DOCUMENTATION DOCUMENTATION "Read a value < 3" 6 134 1 60 0 )
(PROPERTIES PROPERTIES () 10 400 0 60 0 )
) (
(END END1 0 0 317 379)
(PROCESS N1 0 0 323 255)
(PROCESS N0 0 0 322 140)
(START START 0 0 310 10)
) (
(GOAL N1 E2 END1
(~> (WAIT-TEST2 $X))
()  0 0 40 0)
(GOAL N0 E1 N1
(! (PRINT $X))
()  0 0 40 0)
(GOAL START E0 N0
(^ (& (WAIT-TEST2 $X)
      (> 3 $X)))
()  0 0 40 0)
) )
(|Test Read Inside Id Var| (
(INVOCATION INVOCATION (TEST-READ-RESPONSE-ID-VAR) 11 50 1 80 0 )
(CONTEXT CONTEXT  10 150 0 60 0 )
(SETTING SETTING  10 250 0 60 0 )
(EFFECTS EFFECTS () 10 350 0 60 0 )
(DOCUMENTATION DOCUMENTATION "This OP will sleep until it gets 
twice the same value." 6 158 1 60 0 )
(PROPERTIES PROPERTIES () 10 400 0 60 0 )
) (
(END END0 0 0 270 463)
(START START 0 0 310 10)
(PROCESS N0 0 0 320 96)
(PROCESS N2 0 0 321 162)
(PROCESS N5 0 0 322 221)
(PROCESS N1 0 0 323 278)
(IF N4 0 0 322 349)
(THEN N4_T 0 0 308 349)
(ELSE N4_F 0 0 343 349)
(PROCESS N3 0 0 488 405)
) (
(GOAL START E0 N0
(! (READ-INSIDE-ID-VAR TEST2 $VAL))
()  0 1 40 0)
(GOAL N0 E1 N2
(! (PRINT "we read one"))
()  0 0 40 0)
(GOAL N2 E0 N5
(! (PRINT $VAL))
()  0 0 40 0)
(GOAL N5 E1 N1
(! (PRINT "we want the same"))
()  0 0 40 0)
(THEN N4 E4 N4_T)
(ELSE N4 E5 N4_F)
(IF N1 E6 N4
(! (READ-INSIDE-ID-VAR TEST2 $VAL))
()  0 0 40 0)
(GOAL N4_T E7 END0
(! (PRINT "we got it"))
()  0 0 40 0)
(GOAL N4_F E2 N3
(! (PRINT "Error"))
()  0 0 40 0)
) )
(|Test Read Inside Id| (
(INVOCATION INVOCATION (TEST-READ-RESPONSE-ID) 11 50 1 80 0 )
(CONTEXT CONTEXT  10 150 0 60 0 )
(SETTING SETTING  10 250 0 60 0 )
(EFFECTS EFFECTS () 10 350 0 60 0 )
(DOCUMENTATION DOCUMENTATION "In this test, the response is identified by the
ID TEST1. It succeds if it got the same response
twice, and fails otherwise." 12 149 1 60 0 )
(PROPERTIES PROPERTIES () 10 400 0 60 0 )
) (
(PROCESS N1 0 0 373 277)
(PROCESS N5 0 0 373 207)
(PROCESS N2 0 0 373 154)
(PROCESS N0 0 0 373 81)
(START START 0 0 362 8)
(END END0 0 0 272 424)
(IF N4 0 0 374 337)
(THEN N4_T 0 0 360 337)
(ELSE N4_F 0 0 395 337)
(PROCESS N3 0 0 442 423)
(END END1 0 0 435 506)
) (
(GOAL N3 E3 END1
(! (FAILED))
()  0 0 40 0)
(GOAL N4_F E2 N3
(! (PRINT "we got another value"))
()  70 -3 40 0)
(GOAL N4_T E7 END0
(! (PRINT "we got it"))
()  -18 7 40 0)
(IF N1 E6 N4
(! (READ-INSIDE-ID TEST1 $VAL))
()  0 0 40 0)
(ELSE N4 E5 N4_F)
(THEN N4 E4 N4_T)
(GOAL START E0 N0
(! (READ-INSIDE-ID TEST1 $VAL))
()  0 1 40 0)
(GOAL N0 E1 N2
(! (PRINT "we read one"))
()  0 0 40 0)
(GOAL N2 E0 N5
(! (PRINT $VAL))
()  0 0 40 0)
(GOAL N5 E1 N1
(! (PRINT "we want the same"))
()  0 0 40 0)
) )
(|Test Read Inside| (
(INVOCATION INVOCATION (TEST-READ-RESPONSE) 11 50 1 80 0 )
(CONTEXT CONTEXT  10 150 0 60 0 )
(SETTING SETTING  10 250 0 60 0 )
(EFFECTS EFFECTS () 10 350 0 60 0 )
(DOCUMENTATION DOCUMENTATION "Test the call to the read-inside action OP.
This OP succeds if we read twice the same value
and fails otherwise." 7 157 1 60 0 )
(PROPERTIES PROPERTIES () 10 400 0 60 0 )
) (
(END END0 0 0 272 392)
(START START 0 0 363 8)
(PROCESS N0 0 0 374 76)
(PROCESS N2 0 0 374 137)
(PROCESS N5 0 0 374 200)
(PROCESS N1 0 0 374 256)
(IF N4 0 0 374 321)
(THEN N4_T 0 0 360 321)
(ELSE N4_F 0 0 395 321)
(PROCESS N3 0 0 448 398)
(END END1 0 0 440 474)
) (
(GOAL START E0 N0
(! (READ-INSIDE $VAL))
()  0 1 40 0)
(GOAL N0 E1 N2
(! (PRINT "we read one"))
()  0 0 40 0)
(GOAL N2 E0 N5
(! (PRINT $VAL))
()  0 0 40 0)
(GOAL N5 E1 N1
(! (PRINT "we want the same"))
()  0 0 40 0)
(THEN N4 E4 N4_T)
(ELSE N4 E5 N4_F)
(IF N1 E6 N4
(! (READ-INSIDE $VAL))
()  0 0 40 0)
(GOAL N4_T E7 END0
(! (PRINT "we got it"))
()  -46 4 40 0)
(GOAL N4_F E2 N3
(! (PRINT "We got anothe value"))
()  27 1 40 0)
(GOAL N3 E3 END1
(! (FAILED))
()  0 0 40 0)
) )
)
